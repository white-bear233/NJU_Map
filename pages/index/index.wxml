<view class="map_container" style="height: {{map_height}}vh;">
  <map class="map" id="map" longitude="{{longitude}}" latitude="{{latitude}}" scale="18" show-location="true" markers="{{markers}}" polyline="{{polyline}}" bindtap ="mapTap" bindmarkertap="markertap">
    <movable-area class="movable-area">
      <movable-view class="movable-view" direction="vertical" y="{{drawerY}}" out-of-bounds="true" bindchange="onDrawerChange" bindtouchend="onDrawerTouchEnd" disabled="{{isMovableViewDisabled}}">

        <!-- 推荐路线按钮 -->
        <button class="recommend-route-button" bindtap="onShowDrawer" style="position: absolute; left: 645rpx; top: -100rpx">
          <view class="icon-with-text">
            <t-icon name="subway-line" size="25px" color="white" style="position: absolute; right: 22%; top: 10%;" />
            <text class="icon-text" style="position: absolute; top: 50%;">推荐路线</text>
          </view>
        </button>

        <!-- 目标定位按钮 -->
        <button class="recommend-route-button" bindtap="mapAiming" style="position: absolute; left: 645rpx; top: -200rpx">
          <t-icon name="map-aiming" size="25px" color="white" />
        </button>
        <!-- 照片墙按钮 -->
        <button class="recommend-route-button" bindtap="getPicture" style="position: absolute; left: 645rpx; top: -300rpx">
          <view class="icon-with-text">
            <t-icon name="image-search" size="25px" color="white" style="position: absolute; right: 22%; top: 10%;" />
            <text class="icon-text" style="position: absolute; top: 50%;">照片墙</text>
          </view>
        </button>

        <view class="drawer">
          <!-- 顶栏容器 -->
          <view class="top-bar">
            <!-- 标题居中 -->
            <text class="title" style="height: 30px; font-size: 20px; color: rgb(155, 42, 144);">推荐路线</text>
          </view>
          <t-tabs animation="{{ { duration: 0.6 } }}" defaultValue="{{0}}" bind:change="onTabsChange" t-class="custom-tabs" t-class-content="custom-panel" >
            <t-tab-panel label="寻根之旅" value="0" icon="city-ancient-1">
              <view class="custom-panel__content">
                <scroll-view class="route-wrapper-container">
                  <view class="route-wrapper " bindtap="onLinkClick">
                    <view class="top-section">
                      <view class="picture-description">
                        <text style="position: relative; left: 35%;">图 | 北大楼细部</text>
                      </view>
                    </view>
                    <view class="bottom-section">
                      <text class="route-title">历史寻根之旅</text>
                      <text class="route-description">寻访鼓楼校区历史建筑，品味建筑之美</text>
                      <button class="ellipse-button" catch:tap="startNavigate">去探索</button>
                    </view>
                  </view>
                </scroll-view>
              </view>
            </t-tab-panel>
            <t-tab-panel label="体验生活" value="1" icon="joyful">
              <view class="custom-panel__content">
                <scroll-view class="route-wrapper-container">
                  <view class="route-wrapper " bindtap="onLinkClick">
                    <view class="top-section">
                      <view class="picture-description">
                        <text style="position: relative; left: 35%;">图 | 北大楼细部</text>
                      </view>
                    </view>
                    <view class="bottom-section">
                      <text class="route-title">历史寻根之旅</text>
                      <text class="route-description">寻访鼓楼校区历史建筑，品味建筑之美</text>
                      <button class="ellipse-button">去探索</button>
                    </view>
                  </view>
                </scroll-view>
              </view>
            </t-tab-panel>
            <t-tab-panel label="选项三" value="2">
              <view class="custom-panel__content">选项三内容</view>
            </t-tab-panel>
            <t-tab-panel label="选项四" value="3">
              <view class="custom-panel__content">选项四内容</view>
            </t-tab-panel>
          </t-tabs>
        </view>
      </movable-view>
    </movable-area>
    <view class="overlay" wx:if="{{showOverlay}}">
      <view class="info-window">
        <!-- 顶栏容器 -->
        <view class="top-bar">
          <!-- 标题居中 -->
          <text class="title">路线详情</text>
          <!-- 关闭按钮 -->
          <view class="close-button" catch:tap="closeDialog">
            <t-icon name="close-circle" size="25px" color="black" />
          </view>
        </view>
        <RouteDetail></RouteDetail>
      </view>
    </view>
    <view class="overlay" wx:if="{{showSpotDetail}}">
      <view class="info-window">
        <!-- 顶栏容器 -->
        <view class="top-bar">
          <!-- 标题居中 -->
          <text class="title">景点详情</text>
          <!-- 关闭按钮 -->
          <view class="close-button" catch:tap="closeDialog">
            <t-icon name="close-circle" size="25px" color="black" />
          </view>
        </view>
        <SpotDetail 
          images="{{SpotImages}}" 
          description="{{SpotDescription}}"
        ></SpotDetail >
      </view>
    </view>
  </map>
</view>